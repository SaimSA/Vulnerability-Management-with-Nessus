The objective of this lab exercise was to improve my familiarity with Vulnerability Management. I chose Nessus to do this lab because I already had some experience with Nessus during my time at University
and with TryHackme, so I wanted to further my skills on Nessus. The setup featured Nessus Essentials software, VMWare Workstation Player, and a Windows 10 ISO. I followed the Nessus tutorial made by Josh Madakor.


After setting up Nessus Essentials and the Windows 10 VM, I used the "Create a new scan" function in Nessus to begin looking for Vulnerabilites in the VM. I selected the basic network scan to start off. 
![image](https://github.com/SaimSA/Vulnerability-Management-with-Nessus/assets/131204778/509308ab-eb0f-4900-a430-6d90b82e7e37)

I put "Windows 10 Host" as the name and the IP address of the target Windows 10 VM, which we find in the VM with the ipconfig command on the command prompt.

![image](https://github.com/SaimSA/Vulnerability-Management-with-Nessus/assets/131204778/5466e42c-eabd-4354-90d6-870c7c9c50f0)

This scan can also be scheduled, create notifications, scan with credentials entered, assess web vulnerabilities and more. For this time I left everything as default. After saving the scan, it was time to launch it. The scan took a few minutes to complete, and found 31 "info" vulnerabilities, and 2 "medium" vulnerabilities. 

![image](https://github.com/SaimSA/Vulnerability-Management-with-Nessus/assets/131204778/9ddb14bc-9001-489c-a486-9d86c0ec03da)

Looking at one of them, "SMB Signing not required", it provides an explanation, a solution, and some links to get further info about this vulnerability.
Next, the same scan was done again but with credentials of the VM entered this time, to search for even more vulnerabilities that it could not do in the previous scan. We will have to configure the VM for credentials scans.


![image](https://github.com/SaimSA/Vulnerability-Management-with-Nessus/assets/131204778/3a1a0d97-e1a1-4c7b-afa5-c95969821e23)

Firstly, remote registry is enabled on Services, which will allow the scan to connect to the registry, to look for vulnerable/insecure configs.

![image](https://github.com/SaimSA/Vulnerability-Management-with-Nessus/assets/131204778/2b5864cd-1232-4728-a834-9139ef22bff3)

We then go to User Account control settings and change to never notify.

![image](https://github.com/SaimSA/Vulnerability-Management-with-Nessus/assets/131204778/d70f95a9-7d8b-4f02-842a-1d613694f300)

Lastly, we go to the Registry Editor to add a key that further disables user account control. Within Computer\HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System, we will create a DWORD called "LocalAccountTokenFilterPolicy", then set its value to 1.

The VM is now ready for a scan with credentials provided. I input the username and password of the VM into the configure section of the same scan, then ran it again.

![image](https://github.com/SaimSA/Vulnerability-Management-with-Nessus/assets/131204778/d3ff353a-2811-4c17-96b0-049e7d033675)

The credentials scan had more found vulnerabilites as it could look at the file system, services, registry etc.

![image](https://github.com/SaimSA/Vulnerability-Management-with-Nessus/assets/131204778/e0466cd9-3708-4dae-ae0f-8dfcc184308c)

The medium and higher vulnerabilities featued registry issues, softwares needing updates, windows secuirty, ip forwarding enabled in firewall, and smb signing not required.

![image](https://github.com/SaimSA/Vulnerability-Management-with-Nessus/assets/131204778/4c4b174d-9c11-4408-9a0f-e0fc1b211735)

The fixes for them were simple and explained in the details of each vulnerability. 

![image](https://github.com/SaimSA/Vulnerability-Management-with-Nessus/assets/131204778/b166328b-0058-444d-b231-098923680ce7)

Before fixing these vulnerabilites, I downloaded an old version of Firefox to the VM to see what Nessus would find in a scan with this installed. 

![image](https://github.com/SaimSA/Vulnerability-Management-with-Nessus/assets/131204778/6a0c7944-6e12-4cb9-8f7f-7585620a9350)
The scan this time found much more vulnerabilities, 82 critical, 85 high, and 17 medium. 

![image](https://github.com/SaimSA/Vulnerability-Management-with-Nessus/assets/131204778/edd1ea22-e750-459a-87f6-76a0e7d5ddde)
In total, Nessus found a massive 171 vulnerabilites for this version of Firefox. The simple and obvious remedy for this is to either uninstall this or upgrade it, so there aren't any difficult steps in the remediation stage. However it was good to see just how dangerous it could be to not have updated software on your systems. 

![image](https://github.com/SaimSA/Vulnerability-Management-with-Nessus/assets/131204778/2142d3b4-035d-4028-8212-3573d923ca1c)

In the remediation stage, I started off by uninstalling Firefox via the control panel, then installed all pending windows updates.

![image](https://github.com/SaimSA/Vulnerability-Management-with-Nessus/assets/131204778/e49094ca-8c8e-4ec9-be99-536daa3393bc)

![image](https://github.com/SaimSA/Vulnerability-Management-with-Nessus/assets/131204778/55625650-767d-4047-bf59-35fe3741f013)

A further scan revealed much less serious vulnerabilities, but some more was to be done with some more medium and above vulnerabilities detected. I therefore uninstalled Internet Explorer and disabled it in the group policy editor, as that had a critical vulnerability. I then added and enabled the registry value EnableCertPaddingCheck, which prevents a remote code execution vulnerability involving the WinVerifyTrust function (CVE-2013-3900). I uninstalled VMware tools, and deleted Curl as the installed Curl version was vulnerable to denial of service attacks. I disabled IP forwarding by setting the key "IPEnableRouter" to 0 in the registry, which can prevent firewall bypassing. Lastly, I enabled "Digitally sign communications (always)", which ensures signing in is required on the remote SMB server.

![image](https://github.com/SaimSA/Vulnerability-Management-with-Nessus/assets/131204778/314d7810-2b4d-486a-9027-0d8ff4568839)

After all the changes, the final scan found no significant vulnerabilities.

This lab was very useful in giving me experience in the use of Nessus for Vulnerability management, and the remediation process for vulnerabilities so thanks again to Josh Madakor for the tutorial.
https://youtu.be/lT6Px9zJM3s?si=uqU9ak2nk3LsHvPq
